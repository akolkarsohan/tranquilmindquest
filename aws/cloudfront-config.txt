# CloudFront Distribution Configuration for TranquilMindQuest

## Distribution Settings
- **Distribution ID**: [To be filled after creation]
- **Domain Name**: [Auto-generated by CloudFront]
- **Status**: Enabled
- **Price Class**: Use All Edge Locations (Best Performance)

## Origin Settings
- **Origin Domain**: tranquilmindquest.com.s3.amazonaws.com
- **Origin Path**: (leave empty)
- **Origin Access Control**: Create new OAC
- **Origin Shield**: Disabled

## Default Cache Behavior
- **Path Pattern**: Default (*)
- **Viewer Protocol Policy**: Redirect HTTP to HTTPS
- **Allowed HTTP Methods**: GET, HEAD, OPTIONS, PUT, POST, PATCH, DELETE
- **Cache Policy**: Managed-CachingOptimized
- **Origin Request Policy**: Managed-CORS-S3Origin
- **Response Headers Policy**: Managed-SecurityHeadersPolicy

## Cache Behaviors

### Static Assets (CSS, JS, Images)
- **Path Pattern**: /css/*, /js/*, /images/*
- **Viewer Protocol Policy**: Redirect HTTP to HTTPS
- **Allowed HTTP Methods**: GET, HEAD, OPTIONS
- **Cache Policy**: Managed-CachingOptimized
- **TTL Settings**:
  - Default TTL: 31536000 (1 year)
  - Maximum TTL: 31536000 (1 year)
  - Minimum TTL: 0

### HTML Files
- **Path Pattern**: /*.html
- **Viewer Protocol Policy**: Redirect HTTP to HTTPS
- **Allowed HTTP Methods**: GET, HEAD, OPTIONS
- **Cache Policy**: Managed-CachingDisabled
- **TTL Settings**:
  - Default TTL: 0
  - Maximum TTL: 0
  - Minimum TTL: 0

## Custom Error Pages
- **Error Code**: 403 (Forbidden)
  - Response Page Path: /index.html
  - HTTP Response Code: 200
  - Error Caching Minimum TTL: 0

- **Error Code**: 404 (Not Found)
  - Response Page Path: /index.html
  - HTTP Response Code: 200
  - Error Caching Minimum TTL: 0

## SSL/TLS Configuration
- **SSL Certificate**: Custom SSL Certificate (ACM)
- **Certificate ARN**: [To be filled after certificate creation]
- **Security Policy**: TLSv1.2_2021
- **Cipher Suites**: Modern

## Security Headers
- **Strict-Transport-Security**: max-age=31536000; includeSubDomains; preload
- **X-Content-Type-Options**: nosniff
- **X-Frame-Options**: DENY
- **X-XSS-Protection**: 1; mode=block
- **Referrer-Policy**: strict-origin-when-cross-origin
- **Content-Security-Policy**: default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://www.google-analytics.com;

## Geographic Restrictions
- **Restriction Type**: None (Allow all countries)

## WAF Configuration
- **Web ACL**: [Optional - for additional security]
- **Rules**: 
  - Rate limiting
  - SQL injection protection
  - XSS protection
  - IP reputation lists

## Logging
- **Access Logging**: Enabled
- **Log Bucket**: tranquilmindquest-logs.s3.amazonaws.com
- **Log Prefix**: access-logs/
- **Cookie Logging**: Disabled

## Monitoring and Alarms
- **CloudWatch Metrics**: Enabled
- **Real User Monitoring**: Enabled
- **Custom Metrics**: 
  - Cache hit ratio
  - Origin response time
  - Error rate
  - Bandwidth usage

## Lambda@Edge Functions
- **Viewer Request**: [Optional - for request modification]
- **Origin Request**: [Optional - for origin request modification]
- **Origin Response**: [Optional - for response modification]
- **Viewer Response**: [Optional - for response modification]

## Cost Optimization
- **Compression**: Enabled (Gzip and Brotli)
- **HTTP/2**: Enabled
- **HTTP/3**: Enabled (if supported)
- **Origin Shield**: Disabled (for cost savings)

## Performance Optimization
- **Connection Timeout**: 10 seconds
- **Connection Attempts**: 3
- **Keep-Alive Timeout**: 5 seconds
- **Origin Response Timeout**: 30 seconds

## CORS Configuration
```json
{
  "CORSRules": [
    {
      "AllowedHeaders": ["*"],
      "AllowedMethods": ["GET", "HEAD"],
      "AllowedOrigins": ["*"],
      "ExposeHeaders": ["ETag"],
      "MaxAgeSeconds": 3000
    }
  ]
}
```

## Cache Invalidation
- **Invalidation Paths**: 
  - /* (for full site updates)
  - /css/* (for CSS updates)
  - /js/* (for JavaScript updates)
  - /images/* (for image updates)

## Health Checks
- **Health Check Path**: /index.html
- **Health Check Interval**: 30 seconds
- **Healthy Threshold**: 2
- **Unhealthy Threshold**: 3
- **Timeout**: 5 seconds

## Custom Domain Configuration
- **Domain Name**: tranquilmindquest.com
- **SSL Certificate**: [Certificate ARN from ACM]
- **DNS Configuration**: 
  - A Record: tranquilmindquest.com → CloudFront distribution
  - CNAME Record: www.tranquilmindquest.com → tranquilmindquest.com

## Backup and Recovery
- **S3 Cross-Region Replication**: Enabled
- **Backup Bucket**: tranquilmindquest-backup.s3.amazonaws.com
- **Versioning**: Enabled
- **Lifecycle Policies**: 
  - Transition to IA after 30 days
  - Transition to Glacier after 90 days
  - Delete after 365 days

## Security Best Practices
- **Origin Access Control**: Enabled
- **Restrict Viewer Access**: Disabled (public content)
- **Field-Level Encryption**: Disabled (not needed for static content)
- **Query String Forwarding**: None (for better caching)

## Performance Monitoring
- **Real User Monitoring (RUM)**: Enabled
- **Core Web Vitals**: Tracked
- **Custom Events**: 
  - Page load time
  - User interactions
  - Error tracking
  - Conversion events

## Content Delivery Optimization
- **Edge Locations**: Global
- **Origin Shield**: Disabled (for cost optimization)
- **Regional Edge Caches**: Enabled
- **Cache Behaviors**: Optimized for static content

## Maintenance and Updates
- **Cache Invalidation**: Automated via CI/CD
- **Content Updates**: Deployed via S3 sync
- **Security Updates**: Applied automatically
- **Performance Monitoring**: Continuous

---

## Deployment Commands

### Create Distribution
```bash
aws cloudfront create-distribution \
  --distribution-config file://cloudfront-config.json
```

### Update Distribution
```bash
aws cloudfront update-distribution \
  --id DISTRIBUTION_ID \
  --distribution-config file://cloudfront-config.json
```

### Create Invalidation
```bash
aws cloudfront create-invalidation \
  --distribution-id DISTRIBUTION_ID \
  --paths "/*"
```

### Get Distribution Status
```bash
aws cloudfront get-distribution \
  --id DISTRIBUTION_ID
```

---

**Note**: Replace placeholders like [ACCOUNT-ID], [DISTRIBUTION-ID], and [Certificate ARN] with actual values from your AWS account.
